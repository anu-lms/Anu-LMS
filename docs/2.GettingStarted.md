# Getting started with the application

## Make commands

```

up - Build and run docker containers
stop - Stop docker containers
restart - Restart docker containers
down - Stop and Remove docker containers
shell - Log in 
shell:node - 
cr - Clear drupal cache
reinstall - Reimport database from stage environment and run updates
db:dump - Create a dump from stage env and place it in /drupal/backup
db:dump:local - Create a dump from current local env and place it in /drupal/backup
db:import - Import stored database from stage envarinment
db:import:local - Import stored database from local envarinment
update - Run application updates (composer install, rebuild caches etc.)

# Examples:
# make tests
# make tests frontend/DashboardCest.php:viewDashboard
tests:
#	Remove the first argument `tests` from the list of make commands.
	$(eval ARGS := $(filter-out $@,$(MAKECMDGOALS)))
	@echo "${YELLOW}Running tests $(ARGS)...${COLOR_END}"
	docker-compose run codecept run acceptance $(ARGS) --debug

tests:debug:
	docker-compose run codecept run acceptance --group debug --debug

eslint:
	@echo "${YELLOW}Analysing js code for the standats following...${COLOR_END}"
	docker-compose exec node yarn eslint

# Check custom modules in /modules/anu folder for coding standarts.
# Examples:
# make cscheck
# make cscheck anu_search
cscheck:
#	Remove the first argument `tests` from the list of make commands.
	$(eval ARGS := $(filter-out $@,$(MAKECMDGOALS)))
	$(call docker, ./vendor/bin/phpcs --config-set installed_paths ../../drupal/coder/coder_sniffer)
	$(call docker, ./vendor/bin/phpcs --config-set show_progress 1)
	$(call docker, ./vendor/bin/phpcs --colors --warning-severity=0 --standard=Drupal ./web/modules/anu/$(ARGS))

# Fix issues with coding standarts in /modules/anu folder.
# Examples:
# make csfix
# make csfix anu_search
csfix:

``` 


## CLI to work with ReactJS application

To access all `npm` and `yarn` commands you can simply run shell inside of `node` Docker container:

```
docker-compose run node sh
```

Then use `npm` or `yarn` CLI as usual. For example, add a new package:

```
yarn add lodash
```

All you'll need to commit is the change to `package.json` and `package.json` files.


## CLI to work with Drupal application

To access CLI to manage Drupal, run shell inside of `php` Docker container:

```
docker-compose run php sh
```

Then run any command you need. It's possible to use `composer`, `drush`, `drupal`.

If you want to run a single command inside of the container then you don't have to run shell first. Just do it this way:

```
docker-compose run php composer require drupal/devel:~1.0
```

After that commit resulting `composer.json` and `composer.lock` files.

Note that Drush and Drupal Console have to be invoked inside of `web` folder, so you'll have to `cd web` first.

Alternatively, you might use the following command to run `drush` or `drupal` CLI outside of Docker container:
 
```
docker-compose run php drush --root="./web/" <COMMAND>
```

If this command seems to be too long to type every time, consider adding it to the list of your bash aliases:
 
```
alias dockerdrush=docker-compose run php drush --root="./web/"
```

Then you'll be able to do something like this:

```
dockerdrush cr
```
