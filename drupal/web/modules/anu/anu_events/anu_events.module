<?php
use Drupal\anu_events\Event\ReplyToCommentEvent;
use Drupal\anu_events\Event\AnuEvents;

/**
 * @file
 * Contains hooks definition for Anu Events module.
 */

/**
 * Implements hook_ENTITY_TYPE_insert().
 *
 * @param \Drupal\Core\Entity\EntityInterface $entity
 */
function anu_events_paragraph_comment_insert(Drupal\Core\Entity\EntityInterface $entity) {
  if ($entity->bundle() != 'paragraph_comment') {
    return;
  }

  if (!empty($entity->field_comment_parent->getValue())) {
    $event = new ReplyToCommentEvent($entity);
    if ($event->createMessage()) {
      \Drupal::service('event_dispatcher')->dispatch(AnuEvents::REPLY_TO_COMMENT, $event);
    }
  }
}
